"use strict";!function(){var e=document.querySelector(".js-clip"),t=e.innerHTML;439<t.length&&screen.width<=1023&&(t=t.substr(0,439),e.innerHTML=t+"..")}(),function(){var n=document.querySelectorAll(".footer__button");Array.from(n).forEach(function(o){o.addEventListener("click",function(e){e.preventDefault();var t=o.nextElementSibling;if(!o.classList.contains("js-closed"))return o.classList.add("js-closed"),void t.classList.add("js-hidden");Array.from(n).forEach(function(e){e.classList.contains("js-closed")||(e.classList.add("js-closed"),e.nextElementSibling.classList.add("js-hidden"))}),o.classList.remove("js-closed"),t.classList.remove("js-hidden")})})}(),window.maskPhoneNumper=function(e,t){var n=8,s=37,a=39,i=46,r=e.querySelector(".js-phone"),l=e.querySelector(".form__textarea"),c=function(e){e.preventDefault(),r.value="+7 (",r.removeEventListener("keydown",c),r.removeEventListener("click",c);var o=r.value.length;r.addEventListener("keydown",function(e){0<=e.key&&e.key<=9||e.keyCode===n||e.keyCode===i||e.keyCode===s||e.keyCode===a||e.preventDefault();var t=r.value.length;t<o?o--:(t<5&&(r.value="+7 ("),7===t&&(r.value=r.value+") "),12===t&&(r.value=r.value+"-"),15===t&&(r.value=r.value+"-"),17<t&&e.keyCode!==n&&e.keyCode!==i&&e.keyCode!==s&&e.keyCode!==a&&l.focus(),o++)})};r.addEventListener("keydown",c),r.addEventListener("click",c),t&&(r.removeEventListener("keydown",c),r.removeEventListener("click",c))},function(){function o(e){var t=e.validity;"submit"!==e.type&&"checkbox"!==e.type?t.valueMissing?e.setCustomValidity("Заполните поле"):t.tooShort?e.setCustomValidity("Мало букв"):t.tooLong?e.setCustomValidity("Много букв"):t.patternMismatch?e.setCustomValidity("не подходит по паттерну"):e.setCustomValidity(""):"checkbox"===e.type&&(t.valueMissing?e.setCustomValidity("Согласитесь с правилами обработки данных"):e.setCustomValidity(""))}window.formValidate=function(e,t){Array.from(e.elements).forEach(function(e){t?e.removeEventListener("invalid",o(e)):e.addEventListener("invalid",o(e))})}}(),window.elementInViewport=function(e){for(var t=e.offsetTop,o=e.offsetLeft,n=e.offsetWidth,s=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,o+=e.offsetLeft;return t>=window.pageYOffset&&o>=window.pageXOffset&&t+s<=window.pageYOffset+window.innerHeight&&o+n<=window.pageXOffset+window.innerWidth},window.setLocalStorage=function(e){var t=e.querySelector("[name=name]"),o=e.querySelector("[name=phone]"),n=e.querySelector("[name=message]"),s=!0,a={name:"",phone:"",message:""};try{a.name=localStorage.getItem("nameField"),a.phone=localStorage.getItem("phoneField"),a.message=localStorage.getItem("messageField")}catch(e){s=!1}e.addEventListener("submit",function(){window.formValidate(e,!1),s&&(localStorage.setItem("nameField",t.value),localStorage.setItem("phoneField",o.value),localStorage.setItem("messageField",n.value))}),window.elementInViewport(e)&&(""===a.name&&t.focus(),""!==a.name&&(t.value=a.name,o.focus()),""!==a.phone&&(o.value=a.phone,n.focus()),""!==a.message&&(n.value=a.message),null===a.message&&(n.value=""))},function(){function t(e){e.preventDefault(),o.classList.add("js-popup-show"),document.querySelector("body").classList.add("no-scroll"),n.addEventListener("click",i),s.addEventListener("click",i),document.addEventListener("keydown",r),window.maskPhoneNumper(a,!1),window.setLocalStorage(a)}var e=document.querySelectorAll(".js-popup-open"),o=document.querySelector(".popup"),n=o.querySelector(".popup__close"),s=document.querySelector(".overlay"),a=o.querySelector(".popup__form"),i=function(e){e.preventDefault(),o.classList.remove("js-popup-show"),s.removeEventListener("click",i),document.removeEventListener("keydown",r),window.maskPhoneNumper(a,!0),window.formValidate(a,!0),document.querySelector("body").classList.remove("no-scroll")},r=function(e){27===e.keyCode&&i(e)};e.forEach(function(e){e.addEventListener("click",t)})}(),function(){var e=document.querySelector(".feedback__form");window.maskPhoneNumper(e,!1),window.setLocalStorage(e)}(),document.querySelectorAll(".js-scroll").forEach(function(n){n.addEventListener("click",function(e){e.preventDefault();var t=document.querySelector(n.getAttribute("href")).getBoundingClientRect().top,o=setInterval(function(){var e=t/20;e>window.pageYOffset-t&&window.innerHeight+window.pageYOffset<document.body.offsetHeight?window.scrollBy(0,e):(window.scrollTo(0,t),clearInterval(o))},20)})});